<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Color Picker - Davanico</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
    }

    body {
      background: #eef3fd;
      padding: 1em;
    }

    .container {
      max-width: 600px;
      margin: auto;
      background: #fff;
      padding: 2em;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }

    a.back-btn {
      display: inline-block;
      margin-bottom: 1em;
      text-decoration: none;
      color: #1a73e8;
      font-weight: bold;
    }

    .drop-area {
      border: 2px dashed #1a73e8;
      border-radius: 10px;
      padding: 1.5em;
      text-align: center;
      color: #1a73e8;
      cursor: pointer;
      margin-bottom: 1em;
    }

    .drop-area.dragover {
      background-color: #e3edfd;
    }

    #preview-img {
      width: 100%;
      max-height: 300px;
      object-fit: contain;
      border-radius: 10px;
      margin-bottom: 1em;
      cursor: crosshair;
      border: 2px solid #d9e3f5;
    }

    .result-box {
      background: #f5f7fa;
      padding: 1em;
      border-radius: 10px;
      border: 1px solid #ccc;
      margin-top: 1em;
    }

    .picked-color {
      height: 50px;
      border-radius: 8px;
      border: 1px solid #999;
      margin-bottom: 1em;
    }

    .color-code {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 0.5em;
    }

    .color-code input {
      flex: 1;
      padding: 0.5em;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: #fff;
      font-size: 14px;
    }

    .color-code button {
      padding: 0.5em 0.8em;
      border: none;
      background: #1a73e8;
      color: #fff;
      border-radius: 6px;
      cursor: pointer;
    }

    .color-code button:hover {
      background: #1557b0;
    }

    .alert {
      text-align: center;
      font-size: 14px;
      color: #1a73e8;
      margin-top: 1em;
      display: none;
    }

    input[type="file"] {
      display: none;
    }

    @media (max-width: 480px) {
      .color-code {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="search.html" class="back-btn">&larr; Kembali</a>

    <label for="file-upload" class="drop-area" id="drop-area">
      Tarik atau upload gambar ke sini
      <input type="file" id="file-upload" accept="image/*" />
    </label>

    <img src="img/demo-image-3.jpg" id="preview-img" alt="Preview" />

    <div class="result-box" id="result-box" style="display:none;">
      <div class="picked-color" id="picked-color"></div>

      <div class="color-code">
        <input type="text" id="hex-code" readonly />
        <button onclick="copyToClipboard('hex-code')"><i class="fa fa-copy"></i></button>
      </div>

      <div class="color-code">
        <input type="text" id="rgb-code" readonly />
        <button onclick="copyToClipboard('rgb-code')"><i class="fa fa-copy"></i></button>
      </div>
    </div>

    <div class="alert" id="alert">Warna berhasil disalin!</div>
  </div>

  <script>
    const fileInput = document.getElementById("file-upload");
    const dropArea = document.getElementById("drop-area");
    const previewImg = document.getElementById("preview-img");
    const resultBox = document.getElementById("result-box");
    const pickedColor = document.getElementById("picked-color");
    const hexCode = document.getElementById("hex-code");
    const rgbCode = document.getElementById("rgb-code");
    const alertBox = document.getElementById("alert");

    // Drag-and-drop
    dropArea.addEventListener("dragover", e => {
      e.preventDefault();
      dropArea.classList.add("dragover");
    });

    dropArea.addEventListener("dragleave", () => {
      dropArea.classList.remove("dragover");
    });

    dropArea.addEventListener("drop", e => {
      e.preventDefault();
      dropArea.classList.remove("dragover");
      if (e.dataTransfer.files.length > 0) {
        handleImage(e.dataTransfer.files[0]);
      }
    });

    fileInput.addEventListener("change", () => {
      handleImage(fileInput.files[0]);
    });

    function handleImage(file) {
      if (!file.type.startsWith("image/")) return;
      const reader = new FileReader();
      reader.onload = () => {
        previewImg.src = reader.result;
      };
      reader.readAsDataURL(file);
    }

    previewImg.addEventListener("click", pickColor);
    previewImg.addEventListener("touchstart", function(e) {
      const touch = e.touches[0];
      const rect = previewImg.getBoundingClientRect();
      const x = touch.clientX - rect.left;
      const y = touch.clientY - rect.top;
      extractColor(x, y);
    });

    function pickColor(e) {
      const rect = previewImg.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      extractColor(x, y);
    }

    function extractColor(x, y) {
      const canvas = document.createElement("canvas");
      canvas.width = previewImg.width;
      canvas.height = previewImg.height;
      const ctx = canvas.getContext("2d");
      ctx.drawImage(previewImg, 0, 0, canvas.width, canvas.height);

      const pixel = ctx.getImageData(x, y, 1, 1).data;
      const rgb = `rgb(${pixel[0]}, ${pixel[1]}, ${pixel[2]})`;
      const hex = `#${[pixel[0], pixel[1], pixel[2]]
        .map(x => x.toString(16).padStart(2, "0"))
        .join("")}`;

      pickedColor.style.background = hex;
      hexCode.value = hex;
      rgbCode.value = rgb;
      resultBox.style.display = "block";
    }

    function copyToClipboard(id) {
      const input = document.getElementById(id);
      input.select();
      document.execCommand("copy");
      alertBox.style.display = "block";
      setTimeout(() => (alertBox.style.display = "none"), 2000);
    }
  </script>
</body>
</html>
